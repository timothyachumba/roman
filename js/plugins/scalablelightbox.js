//     ScalableLightbox - v1.0.0 - 2014-10-05

//     (c) 2014 Olivier Hug, BÃ¤nziger Hug Ltd. <oh@baenziger-hug.com>
//     Licensed under the GPL v3, Commercial license
//     https://scalable-lightbox.com/


!function(a){"function"==typeof define&&define.amd?define(["jquery"],a($,window)):a(jQuery,window)}(function(a,b){"use strict";function c(a,c){b.console&&("error"===a?b.console.error?b.console.error(c):b.console.log("ERROR: "+c):"warn"===a?b.console.warn?b.console.warn(c):b.console.log("WARN: "+c):"info"===a?b.console.info?b.console.info(c):b.console.log("INFO: "+c):"log"===a&&b.console.log(c))}a.ScalableLightbox=function(d){var e,f=a.data(document.body,"ScalableLightbox");if(f||(f={$container:null,$indexWrapper:null,$indexOverlay:null,$indexDecksContainer:null,indexState:"closed",$lightboxWrapper:null,$lightboxOverlay:null,$lightboxDecksContainer:null,$lightboxCaptionContainer:null,$lightboxCaptionLeft:null,$lightboxCaptionCenter:null,$lightboxCaptionRight:null,lightboxState:"closed",currentDeck:null,currentIndex:0,currentBlocking:!1,binded:{clicks:!1,touch:!1,keys:!1,resize:!1},prevScrollPosition:[],initPlugin:!1,initMasonry:!1,options:null,settings:{data:[],api:null,debug:!1,resize:"smartresize",hash:!0,baseImgPath:"",index:{enabled:!0,overlay:!0,layout:"float",thumb:{overlay:!0,width:280,caption:"number",captionNumberFmt:"%n% / %total%",captionPosition:"below",captionVerticalMargin:5},controls:{close:!0}},lightbox:{enabled:!0,overlay:!0,padding:{horizontal:100,vertical:100,horizontalMobile:50,verticalMobile:50},img:{captionLeft:"index",captionCenter:"caption",captionRight:"number",captionNumberFmt:"%n% / %total%",captionIndexTxt:"Index",captionPosition:"below",captionVerticalMargin:5},controls:{close:!0,clicks:!0,keys:!0}},callbacks:{loaded:null,open:null,close:null,resize:null},classNames:{clearfix:"clearfix",pluginActive:"sl-active",container:"sl-container",indexOverlay:"sl-index-overlay",indexWrapper:"sl-index-wrapper",indexDecksContainer:"sl-index-decks-container",indexDeck:"sl-index-deck",indexItem:"sl-index-item",indexItemImg:"sl-index-item-img",indexItemIndicator:"sl-index-item-indicator",indexItemOverlay:"sl-index-item-overlay",indexItemCaption:"sl-index-item-caption",indexItemCaptionInner:"sl-index-item-caption-inner",lightboxOverlay:"sl-lightbox-overlay",lightboxWrapper:"sl-lightbox-wrapper",lightboxDecksContainer:"sl-lightbox-decks-container",lightboxDeck:"sl-lightbox-deck",lightboxItem:"sl-lightbox-item",lightboxItemIndicator:"sl-lightbox-item-indicator",lightboxItemCaptionContainer:"sl-lightbox-caption-container",lightboxIndexLink:"sl-lightbox-index-link",lightboxCursor:"sl-lightbox-cursor"},transitions:{fadeInIndexOverlay:500,fadeOutIndexOverlay:500,fadeInIndex:500,fadeOutIndex:500,fadeInIndexItemLoaded:250,fadeInLightboxOverlay:500,fadeOutLightboxOverlay:500,fadeInLightbox:500,fadeOutLightbox:500,fadeInLightboxItemLoaded:250,fadeLightboxItem:250}},_init:function(b,c){var d=this;return this.initPlugin?(d._debug("error","The plugin has already been initialized!"),!1):(this.options=a.extend(!0,{},this.settings,b),void(this.options.index.enabled||this.options.lightbox.enabled?(this.$container=a("<div />").addClass(this.options.classNames.container),a("body").append(this.$container),this._loadData(c)):d._debug("error","Neither the index module, nor the lightbox module is enabled!")))},_loadData:function(b){var c=this,d=function(){return c.options.index.enabled&&c._tmplIndex(),c.options.lightbox.enabled&&c._tmplLightbox(),c.initPlugin=!0,c._loadDecks(b),c._bind(),!0};null!==this.options.api?a.ajax({type:"GET",dataType:"json",url:this.options.api,success:function(a){c._debug("info","Inserted JSON Stream: "),c._debug("info",a),c.options.data=c._normalizeData(a),d()},error:function(a){return c._debug("error","JSON Error occured!"),c._debug("error",a),!1}}):this.options.data.length>0?(this.options.data=this._normalizeData(this.options.data),d()):this._debug("error","The data could not be loaded!")},_normalizeData:function(a){var b=0,c=0,d=0,e=a.length,f=0,g=null,h=null,i=[],j=[];for(b;e>b;b++)if(g=a[b],"undefined"==typeof g.id||"undefined"==typeof g.items||0===g.items.length)i.push(b);else{for(j=[],f=g.items.length,c=0;f>c;c++)h=g.items[c],"undefined"!=typeof h.img&&"undefined"!=typeof h.width&&"undefined"!=typeof h.height?(h.ratio=h.height/h.width,h.loaded=!1,h.thumbloaded="undefined"!=typeof h.thumb&&null!==h.thumb?!1:"same"):j.push(c);if(j.length===g.items.length)i.push(b);else for(j.reverse(),d=0;d<j.length;d++)g.items.splice(j[d],1)}for(i.reverse(),d=0;d<i.length;d++)a.splice(i[d],1);return a},_loadDecks:function(a){var b=this.options.data,c=b.length,d=0;if(a="function"==typeof a?a:!1,this.options.index.enabled){for(d=0;c>d;d++)this.$indexDecksContainer.append(this._tmplIndexDeck(b[d]));this._resizeIndex("all"),this._createMasonry()}if(this.options.lightbox.enabled)for(d=0;c>d;d++)this.$lightboxDecksContainer.append(this._tmplLightboxDeck(b[d]));this._setDeck(!1),this._bindClicks(),this._hashListener(),a&&a(),"function"==typeof this.options.callbacks.loaded&&this.options.callbacks.loaded()},_loadImgs:function(b){var c=this,d=null,e=this.options.classNames,f=this.options.transitions,g=function(a,b,d,e,g,h){d.after(b),d.hide(),"undefined"!=typeof Modernizr&&Modernizr.csstransitions?b.addClass("loaded"):b.fadeIn(f["fadeIn"+c._capitalize(e)+"ItemLoaded"]),1===g?(a.thumbloaded=!0,a.loaded=!0,c._debug("info","Loading image: "+h)):2===g?(a.thumbloaded=!0,c._debug("info","Loading thumb image: "+h)):3===g&&(a.loaded=!0,c._debug("info","Loading image: "+h))};this.options[b].enabled&&(d=this["$"+b+"DecksContainer"].find("#"+e[b+"Deck"]+"-"+this.currentDeck.id+" ."+e[b+"ItemIndicator"]),"index"===b?a.each(this.currentDeck.items,function(b,e){var h,i=d.eq(b),j=a("<img />");if("loading"===e.thumbloaded)return!1;if("same"===e.thumbloaded)h=c.options.baseImgPath+e.img,e.loaded===!0?(i.after(j.attr("src",h)),i.hide(),"undefined"!=typeof Modernizr&&Modernizr.csstransitions?j.addClass("loaded"):j.fadeIn(f.fadeInIndexItemLoaded),e.thumbloaded=!0,c._debug("info","Appended already loaded image: "+h)):(e.thumbloaded="loading",j.one("load",function(){g(e,j,i,"index",1,h)}).attr("src",h));else{if(e.thumbloaded)return!1;h=c.options.baseImgPath+e.thumb,e.thumbloaded="loading",j.one("load",function(){g(e,j,i,"index",2,h)}).attr("src",h)}}):"lightbox"===b&&a.each(this.currentDeck.items,function(b,e){var h=d.eq(b),i=a("<img />"),j=c.options.baseImgPath+e.img;if("loading"===e.loaded)return!1;if(e.loaded){if(h.parent().find("img").length>0)return!1;h.after(i.attr("src",j)),h.hide(),"undefined"!=typeof Modernizr&&Modernizr.csstransitions?i.addClass("loaded"):i.fadeIn(f.fadeInLightboxItemLoaded),e.loaded=!0,c._debug("info","Appended already loaded image: "+j)}else e.loaded="loading",i.one("load",function(){g(e,i,h,"lightbox",3,j)}).attr("src",j)}))},_setDeck:function(a){var b=!1,c=null,d=this.options.data,e=d.length,f=0;if(a!==!1)for(f;e>f;f++)if(c=d[f],c.id===a){b=!0,this.currentDeck=c;break}b||(this.currentDeck=d[0],this.currentIndex=0)},open:function(b,c){var d=this,e=null,f="",g=this.options.classNames,h=this.options.transitions;return c="function"==typeof c?c:!1,this.currentBlocking?!1:(this.currentBlocking=!0,b=a.extend(!0,{module:"lightbox",deck:!1,index:0},b),this._setDeck(b.deck),this.currentIndex=b.index,e=function(){d["$"+b.module+"DecksContainer"].find("."+g[b.module+"Deck"]).hide(),d["$"+b.module+"DecksContainer"].find("#"+g[b.module+"Deck"]+"-"+d.currentDeck.id).show(),d["$"+b.module+"Wrapper"].fadeIn(h["fadeIn"+d._capitalize(b.module)],function(){d[b.module+"State"]="opened",d._loadImgs(b.module),d._bind(),d._changeHash(b.module),"index"===b.module?d.resize():(d.currentBlocking=!1,d.goto(b.index)),c?c():"function"==typeof d.options.callbacks.open&&d.options.callbacks.open()}),a("body").addClass(g.pluginActive),d.currentBlocking=!1},f="index"===b.module?"lightbox":"index",void(this.options[b.module].enabled?("opened"===this[f+"State"]&&this.close(),"index"===b.module&&this._resizeIndex("current"),this.options[b.module].overlay?this["$"+b.module+"Overlay"].fadeIn(h["fadeIn"+d._capitalize(b.module)+"Overlay"],e):e()):this._debug("error","The "+b.module+" module is not activated and can therefore not be displayed!")))},close:function(c){var d=this,e="index",f=this.options.classNames,g=this.options.transitions,h=null;if(c="function"==typeof c?c:!1,"opened"===this.lightboxState)e="lightbox";else if("closed"===this.indexState)return c&&c(),void this._debug("info","Nothing could be closed, as everything is already closed.");this._bind(!0),a("body").removeClass(f.pluginActive),h=function(){d["$"+e+"DecksContainer"].find("#"+f[e+"Deck"]+"-"+d.currentDeck.id).hide(),d[e+"State"]="closed",d._changeHash("close"),"lightbox"===e&&(d.$lightboxDecksContainer.css({width:0,height:0,marginLeft:0,marginTop:0}),d.$lightboxDecksContainer.find("#"+f.lightboxDeck+"-"+d.currentDeck.id+" ."+f.lightboxItem).hide().removeClass("fadein"),d.$lightboxCaptionLeft.html(""),d.$lightboxCaptionCenter.html(""),d.$lightboxCaptionRight.html("")),2===d.prevScrollPosition.length&&(b.scrollTo(d.prevScrollPosition[0],d.prevScrollPosition[1]),d.prevScrollPosition=[]),c?c():"function"==typeof d.options.callbacks.close&&d.options.callbacks.close()},this["$"+e+"Wrapper"].fadeOut(g["fadeOut"+d._capitalize(e)],function(){d.options[e].overlay?d["$"+e+"Overlay"].fadeOut(g["fadeOut"+d._capitalize(e)+"Overlay"],h):h()})},destroy:function(b){b="function"==typeof b?b:!1,this._bind(!0),this._bindClicks(!0),this._bindIndexLink(!0),this._bindThumbLinks(!0),a.fn.masonry&&"masonry"===this.options.index.layout&&(this.$indexDecksContainer.find("."+this.options.classNames.indexDeck).masonry("destroy"),this.initMasonry=!1),this.$container.remove(),a("body").removeClass(this.options.classNames.pluginActive),b&&b(),this._debug("info","Plugin has been successfully removed."),this.options=null,this.initPlugin=!1},prev:function(){this._navigateTo("prev")},next:function(){this._navigateTo("next")},"goto":function(a){this._navigateTo(a)},_navigateTo:function(a){var b=this,c=0,d=0,e=this.options.classNames,f=this.options.transitions;return this.currentBlocking?!1:this.options.lightbox.enabled?"opened"!==this.lightboxState?(this._debug("info","The lightbox module has to be active (displayed) when using a navigation method!"),!1):"string"==typeof a&&1===this.currentDeck.items.length?!1:(this.currentBlocking=!0,"number"==typeof a?(d=a,c=this.$lightboxDecksContainer.find("#"+e.lightboxDeck+"-"+this.currentDeck.id+" ."+e.lightboxItem+".fadein").index(),(d>=this.currentDeck.items.length||0>d)&&(d=this.currentDeck.items.length-1),c===d&&(c=-1)):"prev"===a?(d=this.currentIndex-1,c=this.currentIndex,0>d&&(d=this.currentDeck.items.length-1,c=0)):"next"===a&&(d=this.currentIndex+1,c=d-1,d===this.currentDeck.items.length&&(c=this.currentDeck.items.length-1,d=0)),this.currentIndex=d,c>=0&&this.$lightboxDecksContainer.find("#"+e.lightboxDeck+"-"+this.currentDeck.id+" ."+e.lightboxItem).eq(c).fadeOut(f.fadeLightboxItem).removeClass("fadein"),this.$lightboxDecksContainer.find("#"+e.lightboxDeck+"-"+this.currentDeck.id+" ."+e.lightboxItem).eq(d).fadeIn(f.fadeLightboxItem,function(){b.currentBlocking=!1}).addClass("fadein"),this._adjustLightboxCaption(),this.resize(),void this._changeHash("lightbox")):!1},_adjustLightboxCaption:function(){var a=this.options.lightbox.img;this.$lightboxCaptionLeft.html(this._getCaptionTxt("lightbox",a.captionLeft)),this.$lightboxCaptionCenter.html(this._getCaptionTxt("lightbox",a.captionCenter)),this.$lightboxCaptionRight.html(this._getCaptionTxt("lightbox",a.captionRight))},_getCaptionTxt:function(a,b,c,d,e){var f,g,h="";switch("lightbox"===a&&(c=this.currentDeck.items[this.currentIndex]),f="undefined"!=typeof c.caption?c.caption:"",g="undefined"!=typeof c.thumbcaption?c.thumbcaption:f,b){case"index":if("index"===a||!this.options.index.enabled)break;h='<a href="#" class="',h+=this.options.classNames.lightboxIndexLink,h+='">'+this.options.lightbox.img.captionIndexTxt,h+="</a>";break;case"number":"index"===a?h=this.options.index.thumb.captionNumberFmt.replace(/%n%/gi,d+1).replace(/%total%/gi,e):"lightbox"===a&&(h=this.options.lightbox.img.captionNumberFmt.replace(/%n%/gi,this.currentIndex+1).replace(/%total%/gi,this.currentDeck.items.length));break;case"caption":h=f;break;case"thumbcaption":h=g}return h},_hashListener:function(){var a,c,d,e;this.options.hash&&(a=/#lightbox\/index\/(\d*)/,c=/#lightbox\/(\d*)\/(\d*)/,d=a.exec(b.location.hash),e=c.exec(b.location.hash),d?this.open({module:"index",deck:parseInt(d[1],10)}):e&&this.open({module:"lightbox",deck:parseInt(e[1],10),index:parseInt(e[2],10)}))},_changeHash:function(a){this.options.hash&&("index"===a?b.location.hash="#lightbox/index/"+this.currentDeck.id:"lightbox"===a?b.location.hash="#lightbox/"+this.currentDeck.id+"/"+this.currentIndex:"close"===a&&(b.location.hash=""))},resize:function(c){var d,e,f,g=this,h=a(b).width(),i=a(b).height(),j=h-(451>h||400>i?this.options.lightbox.padding.horizontalMobile:this.options.lightbox.padding.horizontal),k=i-(451>h||400>i?this.options.lightbox.padding.verticalMobile:this.options.lightbox.padding.vertical);c="function"==typeof c?c:!1,"opened"===this.indexState?(this._resizeIndex("current"),c?c():"function"==typeof g.options.callbacks.resize&&g.options.callbacks.resize(),this._debug("info","Index module has been resized.")):"opened"===this.lightboxState&&(this.$lightboxCaptionContainer.hide(),d=this.currentDeck.items[this.currentIndex],d?(e=d.width,f=d.height,e>j&&(e=j,f=e*d.ratio),f>k&&(f=k,e=1*f/d.ratio),this._resizeLightboxCaptions(e),"undefined"!=typeof Modernizr&&Modernizr.csstransitions?(this.$lightboxDecksContainer.css({width:e,height:f,marginLeft:-e/2,marginTop:-f/2}),this.$lightboxCaptionContainer.show(),c?c():"function"==typeof g.options.callbacks.resize&&g.options.callbacks.resize()):this.$lightboxDecksContainer.stop(!0,!1).animate({width:e,height:f,marginLeft:-e/2,marginTop:-f/2},this.options.transitions.fadeLightboxItem,function(){g.$lightboxCaptionContainer.show(),c?c():"function"==typeof g.options.callbacks.resize&&g.options.callbacks.resize()}),this._debug("info","Lightbox module has been resized.")):this._debug("error","The current item of the Lightbox module does not exist!"))},_resizeIndex:function(b){var c=this,d=this.$indexWrapper.is(":visible"),e=this.options.classNames,f=function(){var b=a(this),d=b.is(":visible");d||b.show(),c._resizeIndexCaptions(b),a.fn.masonry&&"masonry"===c.options.index.layout&&c.initMasonry&&b.masonry("resize"),d||b.hide()};d||this.$indexWrapper.show(),"all"===b?this.$indexDecksContainer.find("."+e.indexDeck).each(f):"current"===b&&this.$indexDecksContainer.find("#"+e.indexDeck+"-"+this.currentDeck.id).each(f),d||this.$indexWrapper.hide()},_resizeIndexCaptions:function(b){var c=this,d=this.options.index.thumb.captionPosition,e=this.options.classNames;"above"===d?b.find("."+e.indexItem).each(function(){var b=a(this),d=b.find("."+e.indexItemCaption),f=d.height()+c.options.index.thumb.captionVerticalMargin;b.css("marginTop",""),b.css({marginTop:parseInt(b.css("marginTop"))+f}),d.css({top:-f})}):"center"===d?b.find("."+e.indexItemCaption).each(function(){var b=a(this);b.css({marginTop:-b.height()/2})}):"below"===d&&b.find("."+e.indexItem).each(function(){var b=a(this),d=b.find("."+e.indexItemCaption),f=d.height()+c.options.index.thumb.captionVerticalMargin;b.css("marginBottom",""),b.css({marginBottom:parseInt(b.css("marginBottom"))+f}),d.css({bottom:-f})})},_resizeLightboxCaptions:function(a){var b,c,d=this.options.lightbox.img.captionPosition,e=this.options.lightbox.img.captionVerticalMargin;this.$lightboxCaptionContainer.css({width:a}).show(),this.$lightboxCaptionLeft.css("height","auto"),this.$lightboxCaptionCenter.css("height","auto"),this.$lightboxCaptionRight.css("height","auto"),b=Math.max(this.$lightboxCaptionLeft.height(),this.$lightboxCaptionCenter.height(),this.$lightboxCaptionRight.height()),this.$lightboxCaptionLeft.css("height","100%"),this.$lightboxCaptionCenter.css("height","100%"),this.$lightboxCaptionRight.css("height","100%"),("above"===d||"below"===d)&&(c=b+2*e-this.options.lightbox.padding.vertical/2,c>0&&(b-=c)),"above"===d?this.$lightboxCaptionContainer.css({top:-(b+e)}):"center"===d?this.$lightboxCaptionContainer.css({marginTop:-b/2}):"below"===d&&this.$lightboxCaptionContainer.css({bottom:-(b+e)}),this.$lightboxCaptionContainer.css({width:"",height:b}).hide()},_bind:function(a){a="undefined"==typeof a?!1:a,this._bindKeys(a),this._bindResize(a),this._bindCaptionLinks(a)},_bindKeys:function(c){var d=this;c?(this.options.index.enabled&&this.options.index.controls.close||this.options.lightbox.enabled&&this.options.lightbox.controls.keys)&&(a(b.document).unbind("keydown.scalableLightbox.navi"),a(b.document).unbind("keydown.scalableLightbox.close"),this._debug("info","Unbinding keyboard events."),this.binded.keys=!1):this.binded.keys||(this.options.lightbox.enabled&&this.options.lightbox.controls.keys&&a(b.document).bind("keydown.scalableLightbox.navi",function(a){switch(a.keyCode){case 37:"opened"===d.lightboxState&&d.prev();break;case 39:"opened"===d.lightboxState&&d.next()}}),(this.options.index.enabled&&this.options.index.controls.keys||this.options.lightbox.enabled&&this.options.lightbox.controls.keys)&&(a(b.document).bind("keydown.scalableLightbox.close",function(a){switch(a.keyCode){case 27:("opened"===d.indexState&&d.options.index.controls.close||"opened"===d.lightboxState&&d.options.lightbox.controls.close)&&d.close()}}),this._debug("info","Binded key events."),this.binded.keys=!0))},_bindResize:function(c){var d,e=this,f=!1;c?this.options.resize&&(a(b).unbind("resize.scalableLightbox"),this._debug("info","Unbinding resize event."),this.binded.resize=!1):this.binded.resize||("smartresize"===this.options.resize?(a(b).bind("resize.scalableLightbox",function(){d&&clearTimeout(d),d=setTimeout(function(){e.resize()},200)}),f=!0):this.options.resize&&(a(b).bind("resize.scalableLightbox",function(){e.resize()}),f=!0),f&&(this.binded.resize=!0,this._debug("info","Binded resize event.")))},_bindClicks:function(c){var d=this,e=!1,f=this.options.classNames,g=function(){c?(d.options.index.enabled&&d.options.index.controls.close&&(d.$indexWrapper.off("click.scalableLightbox.indexClose"),e=!0),d.options.lightbox.enabled&&d.options.lightbox.controls.close&&(d.$lightboxWrapper.off("click.scalableLightbox.lightboxClose"),e=!0),d.options.lightbox.enabled&&d.options.lightbox.controls.clicks&&(d.$lightboxDecksContainer.off("click.scalableLightbox.lightboxItem"),d.$lightboxWrapper.off("click.scalableLightbox.leftCursor"),d.$lightboxWrapper.off("click.scalableLightbox.rightCursor"),e=!0),e&&(d._debug("info","Unbinding click events."),d.binded.clicks=!1)):d.binded.clicks||(d.options.index.enabled&&d.options.index.controls.close&&(d.$indexWrapper.on("click.scalableLightbox.indexClose",function(){d.close()}),e=!0),d.options.lightbox.enabled&&d.options.lightbox.controls.close&&(d.$lightboxWrapper.on("click.scalableLightbox.lightboxClose",function(){d.close()}),e=!0),d.options.lightbox.enabled&&d.options.lightbox.controls.clicks&&(d.$lightboxDecksContainer.on("click.scalableLightbox.lightboxItem","."+f.lightboxItem,function(a){a.stopPropagation()}),d.$lightboxWrapper.on("click.scalableLightbox.leftCursor","."+f.lightboxCursor+".left",function(a){a.stopPropagation(),d.prev()}),d.$lightboxWrapper.on("click.scalableLightbox.rightCursor","."+f.lightboxCursor+".right",function(a){a.stopPropagation(),d.next()}),e=!0),e&&(d._debug("info","Binded click events."),d.binded.clicks=!0))};"function"==typeof b.define&&b.define.amd&&"undefined"!=typeof Modernizr&&Modernizr.touch?require(["hammer"],function(){d._bindTouch(c)},function(){g()}):a.fn.hammer&&"undefined"!=typeof Modernizr&&Modernizr.touch?this._bindTouch(c):g()},_bindTouch:function(a){var b=this,c=!1,d=this.options.classNames;a?(this.options.index.enabled&&(this.options.index.controls.close&&this.$indexWrapper.hammer().off("tap.scalableLightbox.indexClose"),this.$indexWrapper.hammer().off("drag.scalableLightbox.indexInner swipe.scalableLightbox.indexInner"),this.$indexWrapper.hammer().off("drag.scalableLightbox.indexOuter swipe.scalableLightbox.indexOuter"),c=!0),this.options.lightbox.enabled&&(this.options.lightbox.controls.close&&this.$lightboxWrapper.hammer().off("tap.scalableLightbox.lightboxClose"),this.$lightboxWrapper.hammer().off("tap.scalableLightbox.leftCursor tap.scalableLightbox.rightCursor"),this.$lightboxWrapper.hammer().off("drag.scalableLightbox.navi"),this.$lightboxDecksContainer.hammer().off("swipe.scalableLightbox.navi"),c=!0),c&&(this._debug("info","Unbinding touch events."),this.binded.touch=!1)):this.binded.touch||(this.options.index.enabled&&(this.options.index.controls.close&&this.$indexWrapper.hammer().on("tap.scalableLightbox.indexClose",function(a){a.gesture.preventDefault(),b.close()}),this.$indexWrapper.hammer().on("drag.scalableLightbox.indexInner swipe.scalableLightbox.indexInner","."+d.indexDecksContainer,function(a){a.stopPropagation()}),this.$indexWrapper.hammer().on("drag.scalableLightbox.indexOuter swipe.scalableLightbox.indexOuter",function(a){a.gesture.preventDefault(),a.gesture.stopPropagation()}),c=!0),this.options.lightbox.enabled&&(this.options.lightbox.controls.close&&this.$lightboxWrapper.hammer().on("tap.scalableLightbox.lightboxClose",function(a){a.gesture.preventDefault(),b.close()}),this.$lightboxWrapper.hammer().on("tap.scalableLightbox.leftCursor","."+d.lightboxCursor+".left",function(a){a.stopPropagation(),b.prev()}),this.$lightboxWrapper.hammer().on("tap.scalableLightbox.rightCursor","."+d.lightboxCursor+".right",function(a){a.stopPropagation(),b.next()}),this.$lightboxWrapper.hammer().on("drag.scalableLightbox.navi",function(a){"left"===a.target.className||"center"===a.target.className||"right"===a.target.className?a.gesture.stopPropagation():(a.gesture.stopPropagation(),a.gesture.preventDefault())}),this.$lightboxDecksContainer.hammer({swipeVelocityX:.4}).on("swipe.scalableLightbox.navi",function(a){switch(a.gesture.preventDefault(),a.gesture.stopPropagation(),a.gesture.direction){case"left":b.next();break;case"right":b.prev()}}),c=!0),c&&(this._debug("info","Binded touch events."),this.binded.touch=!0))},_bindIndexLink:function(c){var d=this,e=this.options.classNames,f=function(){c?d.$lightboxWrapper.hammer().off("tap.scalableLightbox.indexItem"):d.$lightboxWrapper.hammer().on("tap.scalableLightbox.indexItem","a."+e.lightboxIndexLink,function(a){a.stopPropagation(),d.open({module:"index",deck:d.currentDeck.id})})},g=function(){c?d.$lightboxWrapper.off("click.scalableLightbox.indexItem"):d.$lightboxWrapper.on("click.scalableLightbox.indexItem","a."+e.lightboxIndexLink,function(a){a.preventDefault(),a.stopPropagation(),d.open({module:"index",deck:d.currentDeck.id})})};"function"==typeof b.define&&b.define.amd&&"undefined"!=typeof Modernizr&&Modernizr.touch?require(["hammer"],function(){f()},function(){g()}):a.fn.hammer&&"undefined"!=typeof Modernizr&&Modernizr.touch?f():g()},_bindThumbLinks:function(c){var d=this,e=this.options.classNames,f=function(){c?d.$indexWrapper.hammer().off("tap.scalableLightbox.thumbLinks"):d.$indexWrapper.hammer().on("tap.scalableLightbox.thumbLinks","."+e.indexItem,function(b){b.gesture.stopPropagation(),d.options.lightbox.enabled?d.open({module:"lightbox",deck:d.currentDeck.id,index:a(this).index()}):d._debug("error","The lightbox module cannot be opened, because it is not enabled!")})},g=function(){c?d.$indexWrapper.off("click.scalableLightbox.thumbLinks"):d.$indexWrapper.on("click.scalableLightbox.thumbLinks","."+e.indexItem,function(b){b.preventDefault(),b.stopPropagation(),d.options.lightbox.enabled?d.open({module:"lightbox",deck:d.currentDeck.id,index:a(this).index()}):d._debug("error","The lightbox module cannot be opened, because it is not enabled!")})};"function"==typeof b.define&&b.define.amd&&"undefined"!=typeof Modernizr&&Modernizr.touch?require(["hammer"],function(){f()},function(){g()}):a.fn.hammer&&"undefined"!=typeof Modernizr&&Modernizr.touch?f():g()},_bindCaptionLinks:function(c){var d=this,e=this.options.classNames,f=function(){c?(d.options.index.enabled&&d.$indexDecksContainer.hammer().off("tap.scalableLightbox.indexCaptionLinks"),d.options.lightbox.enabled&&d.$lightboxCaptionContainer.hammer().off("tap.scalableLightbox.lightboxCaptionLinks")):(d.options.index.enabled&&d.$indexDecksContainer.hammer().on("tap.scalableLightbox.indexCaptionLinks","."+e.indexItemCaption+" a",function(a){a.gesture.stopPropagation()}),d.options.lightbox.enabled&&d.$lightboxCaptionContainer.hammer().on("tap.scalableLightbox.lightboxCaptionLinks","a:not(."+e.lightboxIndexLink+")",function(a){a.gesture.stopPropagation()}))},g=function(){c?(d.options.index.enabled&&d.$indexDecksContainer.off("click.scalableLightbox.indexCaptionLinks"),d.options.lightbox.enabled&&d.$lightboxCaptionContainer.off("click.scalableLightbox.lightboxCaptionLinks")):(d.options.index.enabled&&d.$indexDecksContainer.on("click.scalableLightbox.indexCaptionLinks","."+e.indexItemCaption+" a",function(a){a.stopPropagation()}),d.options.lightbox.enabled&&d.$lightboxCaptionContainer.on("click.scalableLightbox.lightboxCaptionLinks","a:not(."+e.lightboxIndexLink+")",function(a){a.stopPropagation()}))};"function"==typeof b.define&&b.define.amd&&"undefined"!=typeof Modernizr&&Modernizr.touch?require(["hammer"],function(){f()},function(){g()}):a.fn.hammer&&"undefined"!=typeof Modernizr&&Modernizr.touch?f():g()},_tmplIndex:function(){var b=this.options.classNames;this.options.index.overlay&&(this.$indexOverlay=a("<div />").addClass(b.indexOverlay),this.$container.append(this.$indexOverlay)),this.$indexWrapper=a("<div />").addClass(b.indexWrapper),this.$indexDecksContainer=a("<div />").addClass(b.indexDecksContainer),"float"===this.options.index.layout&&this.$indexDecksContainer.addClass(b.clearfix),this.$indexWrapper.append(this.$indexDecksContainer),this.$container.append(this.$indexWrapper),this._bindThumbLinks()},_tmplIndexDeck:function(b){var c=this.options.classNames,d=a('<div class="'+c.indexDeck+'" id="'+c.indexDeck+"-"+b.id+'"></div>'),e=0,f=b.items.length;for(e;f>e;e++)d.append(this._tmplIndexItem(b.items[e],e,f));return d},_tmplIndexItem:function(b,c,d){var e=this.options.index.thumb.captionPosition,f=this.options.classNames,g=a('<div class="'+f.indexItem+'"><div class="'+f.indexItemOverlay+'"></div><div class="'+f.indexItemImg+'"><div class="'+f.indexItemIndicator+'"></div></div><div class="'+f.indexItemCaption+'"><div class="'+f.indexItemCaptionInner+'"></div></div></div>');return this.options.index.thumb.overlay||g.find("."+f.indexItemOverlay).remove(),("top"===e||"center"===e||"bottom"===e)&&g.find("."+f.indexItemCaption).addClass(e),g.find("."+f.indexItemCaptionInner).html(this._getCaptionTxt("index",this.options.index.thumb.caption,b,c,d)),g.css({height:this.options.index.thumb.width*b.ratio,width:this.options.index.thumb.width}),g},_tmplLightbox:function(){var b,c,d=this.options.lightbox.img.captionPosition,e=this.options.classNames;this.options.lightbox.overlay&&(this.$lightboxOverlay=a("<div />").addClass(e.lightboxOverlay),this.$container.append(this.$lightboxOverlay)),this.$lightboxWrapper=a("<div />").addClass(e.lightboxWrapper),this.$lightboxDecksContainer=a("<div />").addClass(e.lightboxDecksContainer),this.$lightboxWrapper.append(this.$lightboxDecksContainer),this.options.lightbox.controls.clicks&&(b=a("<div />").addClass(e.lightboxCursor).addClass("left"),c=a("<div />").addClass(e.lightboxCursor).addClass("right"),this.$lightboxDecksContainer.append(b),this.$lightboxDecksContainer.append(c)),this.$lightboxCaptionContainer=a("<div />").addClass(e.lightboxItemCaptionContainer),("top"===d||"center"===d||"bottom"===d)&&this.$lightboxCaptionContainer.addClass(d),this.$lightboxCaptionLeft=a("<div />").addClass("left"),this.$lightboxCaptionCenter=a("<div />").addClass("center"),this.$lightboxCaptionRight=a("<div />").addClass("right"),this.$lightboxCaptionContainer.append(this.$lightboxCaptionLeft),this.$lightboxCaptionContainer.append(this.$lightboxCaptionCenter),this.$lightboxCaptionContainer.append(this.$lightboxCaptionRight),this.$lightboxDecksContainer.append(this.$lightboxCaptionContainer),this.$container.append(this.$lightboxWrapper),this._bindIndexLink()},_tmplLightboxDeck:function(b){var c=this.options.classNames,d=a('<div class="'+c.lightboxDeck+'" id="'+c.lightboxDeck+"-"+b.id+'"></div>'),e=0,f=b.items.length;for(e;f>e;e++)d.append('<div class="'+c.lightboxItem+'"><div class="'+c.lightboxItemIndicator+'"></div></div>');return d},_debug:function(a,b){this.options.debug&&c(a,b)},_capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},_createMasonry:function(){var c=this,d=this.options.classNames,e=function(){c.$indexDecksContainer.find("."+d.indexDeck).addClass("masonry").masonry({itemSelector:"."+d.indexItem,isFitWidth:!0,isResizable:!1}),c.initMasonry=!0};"function"==typeof b.define&&b.define.amd?require(["masonry"],function(){e()},function(){c._debug("error","Masonry is activated, however the jQuery Masonry plugin via requirejs is missing!")}):a.fn.masonry&&"masonry"===this.options.index.layout?e():"masonry"===this.options.index.layout&&this._debug("error","Masonry is activated, however the jQuery Masonry plugin is missing!")}},a.data(document.body,"ScalableLightbox",f)),"string"!=typeof d)return f._init(d,"undefined"!=typeof arguments[1]?arguments[1]:!1);if(e=Array.prototype.slice.call(arguments,1),a.isFunction(f[d])&&"_"!==d.charAt(0)){if(f.initPlugin)return f[d].apply(f,e);c("error","Method '"+d+"' called prior to plugin initialization!")}else c("error","No such method '"+d+"' exists!")}});